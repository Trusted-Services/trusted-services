From 2844dada7e52547c95fc438a946d69de36998b37 Mon Sep 17 00:00:00 2001
From: Imre Kis <imre.kis@arm.com>
Date: Tue, 19 Oct 2021 11:48:10 +0200
Subject: [PATCH] Allow aarch64-linux-gcc to compile bare metal lib

Newlib build system determines the target (i.e. Linux, BSD, bare metal,
etc.) according to the toolchain triplet so it would require a
sepearate aarch64-none-elf toolchain to be able to build itself for a
bare metal target.

Signed-off-by: Imre Kis <imre.kis@arm.com>
---
 configure                  | 2 +-
 libgloss/aarch64/configure | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/configure b/configure
index 5db527014..1eb71a806 100755
--- a/configure
+++ b/configure
@@ -3659,7 +3659,7 @@ case "${target}" in
   *-*-freebsd*)
     noconfigdirs="$noconfigdirs target-newlib target-libgloss"
     ;;
-  *-*-linux* | *-*-gnu* | *-*-k*bsd*-gnu | *-*-kopensolaris*-gnu)
+  *-*-k*bsd*-gnu | *-*-kopensolaris*-gnu)
     noconfigdirs="$noconfigdirs target-newlib target-libgloss"
     ;;
   *-*-lynxos*)
diff --git a/libgloss/aarch64/configure b/libgloss/aarch64/configure
index b45256f3c..a25f9f02c 100755
--- a/libgloss/aarch64/configure
+++ b/libgloss/aarch64/configure
@@ -2521,7 +2521,7 @@ test "${CCASFLAGS+set}" = set || CCASFLAGS=$CFLAGS
 
 
 case "${target}" in
-  *-*-elf)
+  *-*-elf | *-linux-gnu)
 	objtype=elf-
 	;;
 esac
-- 
2.33.1

